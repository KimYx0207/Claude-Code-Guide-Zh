# 开发规范与工作流程

## 编码规范
- **文件编码**: UTF-8
- **脚本语言**: Windows Batch (.bat) 用于Hook
- **配置文件**: YAML格式
- **文档**: Markdown格式
- **Python**: 仅用于简单工具脚本（如download_articles.py）

## 项目约定
- **文件命名**: 
  - 文章: `YYYY-MM-DD_主题_风格.md`
  - 技能文件: `SKILL.md`, `skill.yaml`
  - Hook文件: `功能描述.bat`
- **目录组织**: 按功能分类，skills/, commands/, hooks/, articles/
- **版本控制**: 使用V4版本标识，核心文件包含版本信息

## 自动化Hook系统
### 老金风格验证 (laojin-style-check.bat)
- 检查段落长度（≤2句）
- 验证空行使用
- 粗体vs引号检查
- AI腔和禁用词检测
- 7步结构完整性验证
- 固定签名检查

### 自动备份 (auto-backup.bat)
- 每次编辑后自动保存历史版本
- 保留最近10个版本
- 存储在.claude/backups/目录

## MCP服务调用策略
- **单轮单工具原则**: 每次调用只使用一个MCP服务
- **最小必要原则**: 收敛查询范围，避免过度抓取
- **可追溯性**: 记录工具调用简报
- **失败降级**: 服务不可用时给出明确降级说明

## 技能触发机制
- **关键词触发**: 公众号、写文章、老金风格、自然引导等
- **命令触发**: /gongzhonghao, /title, /outline等
- **自动激活**: AI/科技类内容自动应用老金风格

## 质量保证流程
1. **V4检测**: 8维度质量评分
2. **Hook验证**: 自动化风格检查
3. **人工审核**: 最终质量把关
4. **持续优化**: 基于反馈改进

## 开发工作流
1. **需求分析**: 理解写作需求和目标读者
2. **技能选择**: 确定使用哪个技能或命令
3. **MCP调用**: 按需调用外部服务获取信息
4. **内容创作**: 应用V4自然引导系统
5. **质量检测**: 8维度评分+Hook验证
6. **文件组织**: 自动归档到相应目录
7. **SEO优化**: 标题优化和关键词布局

## 测试与验证
- **风格测试**: 使用laojin-style-check.bat验证
- **功能测试**: 测试各项技能和命令
- **集成测试**: 验证MCP服务调用
- **质量测试**: V4系统8维度检测

## 部署维护
- **环境要求**: Windows系统，Claude Code
- **配置管理**: YAML配置文件
- **版本管理**: V4版本标识，更新记录
- **备份策略**: 自动备份+手动归档