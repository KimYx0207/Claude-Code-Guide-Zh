# 路线选择与网络优化指南

**发布时间**: 📅 2025年1月3日
**作者**: ✍️ GAC Code Team
**分类**: 性能优化
**标签**: #网络 #路线 #优化

---

GAC Code 提供多个服务器节点，选择最佳路线可以显著提升使用体验。

### 🌐 为什么需要选择路线？

不同地区、不同运营商的网络环境差异很大，选择合适的路线可以：

- ✅ 降低网络延迟
- ✅ 提高连接稳定性
- ✅ 减少请求失败率
- ✅ 提升整体使用体验

### 🚀 快速选择最佳路线

#### 自动选择（推荐）

运行以下命令，系统会自动测试并推荐最佳路线：

```bash
claude --pick-relay
```

命令会执行以下步骤：

1. 延迟测试 - 测量到各节点的 ping 延迟
2. 带宽测试 - 检测传输速度
3. 稳定性评估 - 分析丢包率和抖动
4. 智能推荐 - 综合评分后推荐最优路线

#### 手动指定路线

如果您已知最佳路线名称，可以直接指定：

```bash
claude --relay [路线名称]
```

```bash
claude --relay shanghai-01
```

### 📊 路线测试原理

#### 延迟测试

测量从您的设备到服务器节点的往返时间（RTT）：

- 优秀: < 50ms
- 良好: 50-100ms
- 一般: 100-200ms
- 较差: > 200ms

#### 带宽测试

测量数据传输速度：

- 下载速度（影响接收响应的速度）
- 上传速度（影响发送请求的速度）

#### 稳定性评估

分析连接质量：

- 丢包率 - 理想值 < 1%
- 抖动 - 延迟波动范围
- 连接成功率 - 建立连接的成功率

### 🎯 选择建议

#### 首次使用

初次安装后，建议立即运行路线选择：

#### 网络环境变化

以下情况建议重新选择路线：

- 🏠 更换了网络环境（家庭/办公室/咖啡厅）
- 📡 更换了运营商
- 🌍 变更了所在地区
- 🐌 发现速度明显变慢

#### 定期优化

建议每周运行一次路线选择，因为：

- 服务器负载会变化
- 网络路由可能调整
- 新节点可能上线

### 📍 可用路线节点

GAC Code 目前提供以下节点（示例）：

注：具体可用节点以实际测试结果为准

### 🔧 高级配置

#### 保存路线配置

路线选择后会自动保存到配置文件：

- macOS/Linux: ~/.claude/config.json
- Windows: %USERPROFILE%\.claude\config.json

#### 手动编辑配置

高级用户可以直接编辑配置文件：

```bash
{
  "relay": {
    "selected": "shanghai-01",
    "fallback": ["shanghai-02", "beijing-01"]
  }
}
```

#### 配置多个备选路线

设置备选路线可以提高稳定性：

```bash
{
  "relay": {
    "primary": "shanghai-01",
    "fallback": ["shanghai-02", "beijing-01", "guangzhou-01"]
  }
}
```

当主路线不可用时，系统会自动切换到备选路线。

### 🐛 常见问题

#### 问题 1：所有路线都很慢

- 本地网络问题
- DNS 解析问题
- 防火墙/代理干扰

```bash
# 1. 检查网络连接
ping gaccode.com

# 2. 刷新 DNS
# macOS/Linux
sudo dscacheutil -flushcache

# Windows
ipconfig /flushdns

# 3. 临时禁用代理测试
```

#### 问题 2：路线选择失败

如果路线选择命令失败：

1. 检查网络连接
2. 确认 API 密钥正确
3. 尝试手动指定路线
4. 联系客服获取帮助

#### 问题 3：选定路线后仍然卡顿

尝试以下方法：

1. 重新运行路线选择
2. 在不同时间段测试
3. 检查本地网络质量
4. 更新 Claude Code 到最新版本

### 📈 性能监控

#### 实时查看连接状态

如果您使用 VS Code 扩展，可以在状态栏看到：

- 当前使用的路线
- 实时延迟显示
- 连接状态指示

#### 查看历史统计

访问 GAC Code 控制台查看：

- 各路线使用时长
- 平均延迟统计
- 连接成功率
- 异常记录

网址：https://gaccode.com/dashboard

### 💡 最佳实践

#### 1. 定期测试

每周固定时间测试路线：

```bash
# 添加到 crontab（Linux/macOS）
0 9 * * 1 claude --pick-relay > ~/claude-relay.log
```

#### 2. 不同时段测试

网络高峰期（如晚上8-10点）和非高峰期的最佳路线可能不同，建议在常用时段测试。

#### 3. 记录最佳路线

为不同环境记录最佳路线：

- 家庭网络：shanghai-01
- 公司网络：beijing-01
- 移动热点：guangzhou-01

#### 4. 使用配置文件

为不同环境准备配置文件：

```bash
# 家庭配置
cp ~/.claude/config-home.json ~/.claude/config.json

# 办公室配置
cp ~/.claude/config-office.json ~/.claude/config.json
```

### 🎓 扩展阅读

- 网络优化高级技巧
- 故障排查指南
- 性能调优最佳实践

### 📞 技术支持

如果路线选择遇到问题，请联系：

- 💬 客服微信：iweico

提示：路线选择是一次性投入，带来持续的体验提升。建议每位用户都花几分钟完成这个设置！
