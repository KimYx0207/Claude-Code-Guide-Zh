# 公众号写作自动化系统 - 产品需求文档 (PRD)

## 1. 项目概览 (Overview)

### 1.1 产品愿景
打造一个完全自动化的公众号文章创作系统,从主题输入到文章发布全流程自动化,确保输出的每篇文章都符合"老金风格"的高质量标准。

### 1.2 核心问题
- 公众号文章创作流程繁琐,需要手动research、写作、配图、质量检测
- 文章质量不稳定,AI腔重、缺乏真实感
- 缺少标准化的质量评估体系
- 手动操作容易遗漏步骤,降低文章质量

### 1.3 目标用户
- 公众号内容创作者
- 自媒体从业者
- 需要批量生产高质量文章的团队

### 1.4 核心价值
- 从主题到成稿全流程自动化,节省80%创作时间
- 8维度质量检测体系,确保文章质量稳定在高水平
- 老金风格自然流畅,避免AI腔和机械化表达
- 自动配图和信息图生成,提升视觉吸引力

## 2. 核心功能 (Core Features)

### 2.1 智能Research系统 ⭐⭐⭐⭐⭐

**功能描述**:
自动判断主题是否需要research,并调用多个MCP工具进行深度信息收集。

**核心能力**:
- 主题类型自动识别(技术测评/趋势分析/经验分享)
- 多工具并行搜索(Brave Search/open-websearch/exa/context7)
- 搜索结果智能整合和去重
- 失败自动降级(MCP工具失败→WebSearch备选)

**为什么重要**:
- 保证文章内容的时效性和准确性
- 提供真实数据支撑,避免编造
- 提升文章专业度和可信度

**实现方式**:
1. 分析主题关键词(最新/趋势/对比/工具名)
2. 按优先级调用MCP工具:
   - 优先级1: brave-search (2000次/月免费)
   - 优先级2: open-websearch (完全免费无限)
   - 优先级3: exa (深度搜索)
   - 优先级4: context7 (技术文档)
3. 整合搜索结果,提取关键信息
4. 生成结构化research报告供写作使用

### 2.2 老金风格写作引擎 ⭐⭐⭐⭐⭐

**功能描述**:
基于V4自然引导理念,生成真实自然、不刻意的高质量文章。

**核心能力**:
- 产品经理视角(不会代码人设)
- 大白话表达,像和朋友聊天
- 真实案例+具体数据支撑
- 自然流畅结构,不死板
- 正确使用顿号序号(1、2、3、)
- 使用**加粗**强调而非"引号"

**为什么重要**:
- 避免AI腔,让文章更有人味儿
- 提升读者信任感和阅读体验
- 形成独特的品牌风格

**实现方式**:
1. 读取 `prompts/laojin-style-v4-natural.md` 风格指南
2. 基于research结果+风格指南生成文章
3. 遵循"自然>完美"原则
4. 自动应用格式规范(顿号/加粗/段落间距)

### 2.3 百万阅读量标题生成器 ⭐⭐⭐⭐⭐

**功能描述**:
基于12大标题公式,自动生成5个爆款级别的SEO标题。

**核心能力**:
- 5大核心要素(情绪冲击/数字对比/痛点打击/反常识/紧迫感)
- 12大标题公式自动应用
- SEO评分和爆款指数评估
- 推荐最佳标题并说明理由

**为什么重要**:
- 标题决定文章点击率
- 专业SEO优化提升曝光
- 数据驱动的标题选择

**实现方式**:
1. 分析文章核心内容和亮点
2. 应用12大公式生成多个候选标题
3. 对每个标题评分(SEO评分/爆款指数)
4. 推荐最佳标题并说明理由(痛点/数字/情绪)

### 2.4 8维度质量检测系统 ⭐⭐⭐⭐⭐

**功能描述**:
客观量化评估文章质量,确保符合老金风格标准。

**核心能力**:
- AI腔检测(<20分合格)
- 自然度检测(>80分合格)
- 真诚度检测(>75分合格)
- 啰嗦度检测(<25分合格)
- 重复度检测(<15%合格)
- 可读性检测(>85分合格)
- 人味儿指数(>70分合格)
- 情感真实性(>75分合格)

**为什么重要**:
- 客观标准避免主观判断
- 及时发现问题并修正
- 确保文章质量稳定

**实现方式**:
1. 使用Python质量检测引擎(`quality_detector.py`)
2. 分析文章内容的8个维度
3. 生成详细质量报告
4. 不通过则提示修改建议

### 2.5 自动配图系统 (V4.1新增) ⭐⭐⭐⭐

**功能描述**:
文章生成后自动搜索或生成相关配图,提升视觉吸引力。

**核心能力**:
- Unsplash无版权高质量图片搜索
- MiniMax AI图片生成(备选)
- 自动插入到文章合适位置
- 配图风格统一管理

**为什么重要**:
- 提升文章视觉吸引力
- 增加读者停留时间
- 提高文章专业度

**实现方式**:
1. 分析文章主题和核心段落
2. 调用Unsplash API搜索相关图片
3. 如果搜索失败,调用MiniMax生成AI图片
4. 自动插入到开头+核心段落位置

### 2.6 信息图生成系统 (V4.1新增) ⭐⭐⭐⭐

**功能描述**:
自动检测文章类型,生成精美的HTML信息图。

**核心能力**:
- 文章类型自动识别(对比/流程/数据)
- HTML信息图生成(对比表格/流程图/数据卡片)
- Playwright自动截图
- 信息图自动嵌入文章

**为什么重要**:
- 让复杂信息一目了然
- 提升专业度和可信度
- 增加读者分享意愿

**实现方式**:
1. 分析文章内容类型(关键词识别)
2. 提取关键数据或对比信息
3. 生成对应类型的HTML信息图
4. 使用Playwright截图并保存
5. 自动嵌入到文章中

### 2.7 Hook验证系统 ⭐⭐⭐⭐

**功能描述**:
Pre/Post Hook自动验证文章符合老金风格规范。

**核心能力**:
- PreToolUse验证research步骤完成
- PostToolUse质量检测和风格检查
- 10项风格规范自动验证
- 不通过则阻止保存

**为什么重要**:
- 强制执行质量标准
- 防止遗漏关键步骤
- 确保文章一致性

**实现方式**:
1. PreToolUse Hook检查research标记
2. PostToolUse Hook运行质量检测
3. 检查10项风格规范(段落长度/粗体/禁用词等)
4. 不通过则返回错误,阻止操作

### 2.8 文件自动组织系统 ⭐⭐⭐

**功能描述**:
自动生成规范文件名并归档到articles目录,自动备份。

**核心能力**:
- 规范文件命名(YYYY-MM-DD_主题_老金风格.md)
- 自动归档到articles目录
- 自动备份(保留10个版本)
- 防止文件冲突

**为什么重要**:
- 保持文件组织规范
- 防止意外丢失
- 方便查找和管理

**实现方式**:
1. 分析文章内容提取主题关键词
2. 生成规范文件名
3. 保存到articles目录
4. 自动备份到.claude/backups

## 3. 用户体验 (User Experience)

### 3.1 用户画像

**主要用户: 老金 - 公众号作者**
- 角色: 产品经理,不会代码
- 需求: 快速创作高质量公众号文章
- 痛点: 手动research耗时,文章质量不稳定
- 期望: 一条命令搞定所有流程

### 3.2 核心用户流程

**主流程: 从主题到成稿**

```
用户输入主题
    ↓
系统自动判断是否需要research
    ↓
[如需要] 自动调用MCP工具research
    ↓
基于research+老金风格生成文章
    ↓
自动生成5个爆款标题
    ↓
[V4.1] 自动配图
    ↓
[V4.1] 自动生成信息图(如适用)
    ↓
PostToolUse Hook质量检测
    ↓
检测通过 → 自动保存到articles
检测不通过 → 提示修改建议
```

**时间估算**: 从主题输入到成稿 < 5分钟

### 3.3 关键交互点

**交互点1: 主题输入**
```
用户: /gongzhonghao Claude Code使用技巧
系统: [自动判断] 检测到工具名,需要research...
      [自动执行] 调用context7查询官方文档...
      [自动执行] 调用open-websearch搜索最新教程...
```

**交互点2: 质量检测反馈**
```
系统: [PostToolUse Hook执行完成]

      ✅ 质量检测通过!
      - AI腔: 12.3分 ✅
      - 自然度: 87.5分 ✅
      - 人味儿: 82.1分 ✅

      文章已保存: articles/2025-11-12_Claude_Code使用技巧_老金风格.md
```

或

```
系统: [PostToolUse Hook执行失败]

      ❌ 质量检测未通过!
      - AI腔: 35.2分 ❌ (需<20分)

      【问题详情】:
      - 发现禁用词: "赋能"、"降本增效"
      - 建议: 用大白话替换专业术语
```

**交互点3: 配图确认 (V4.1)**
```
系统: 文章已生成,是否需要自动配图?
用户: [直接回车默认是] 或 [输入"是"/"否"]
系统: [自动执行] 正在搜索相关配图...
      找到3张高质量图片,已插入文章!
```

### 3.4 UI/UX考量

**设计原则**:
- 零学习成本: 一条命令启动,全程自动化
- 及时反馈: 每个步骤都有清晰提示
- 错误友好: 失败自动降级,不中断流程
- 结果可控: 质量不通过可修改后重试

**关键体验指标**:
- 从主题到成稿时间 < 5分钟
- 质量检测一次通过率 > 90%
- Research工具调用成功率 > 95%
- 配图生成成功率 > 85%

## 4. 技术架构 (Technical Architecture)

### 4.1 系统组件

```
┌─────────────────────────────────────────────────┐
│         用户交互层 (Claude Code CLI)            │
│              /gongzhonghao 命令                  │
└─────────────────────────────────────────────────┘
                        ↓
┌─────────────────────────────────────────────────┐
│           工作流引擎 (workflow_engine.py)       │
│         - 需求解析                               │
│         - 条件路由                               │
│         - 流程编排                               │
└─────────────────────────────────────────────────┘
                        ↓
        ┌───────────────┼───────────────┐
        ↓               ↓               ↓
┌─────────────┐ ┌─────────────┐ ┌─────────────┐
│ Research层  │ │  写作引擎   │ │  配图系统   │
│ - MCP调用   │ │ - 老金风格  │ │ - Unsplash  │
│ - 多工具    │ │ - 标题生成  │ │ - MiniMax   │
│ - 降级策略  │ │ - 信息图    │ │ - Playwright│
└─────────────┘ └─────────────┘ └─────────────┘
                        ↓
┌─────────────────────────────────────────────────┐
│          质量保障层 (Hooks + Detector)          │
│   - PreToolUse Hook (research验证)              │
│   - PostToolUse Hook (质量检测)                 │
│   - 8维度评分系统                                │
└─────────────────────────────────────────────────┘
                        ↓
┌─────────────────────────────────────────────────┐
│       文件管理层 (file_organizer.py)            │
│   - 自动命名                                     │
│   - 自动归档                                     │
│   - 自动备份                                     │
└─────────────────────────────────────────────────┘
```

### 4.2 数据模型

**文章对象 (Article)**
```python
{
    "id": "uuid",
    "topic": "主题",
    "title": "百万阅读量标题",
    "alternative_titles": ["备选标题1", "备选标题2", ...],
    "content": "文章正文markdown",
    "research_data": {
        "tools_used": ["brave-search", "exa"],
        "sources": [{"url": "...", "title": "..."}],
        "key_findings": ["发现1", "发现2"]
    },
    "images": [
        {"url": "...", "position": "开头", "source": "unsplash"}
    ],
    "infographics": [
        {"type": "对比表格", "path": "info1.png"}
    ],
    "quality_score": {
        "ai_tone": 12.3,
        "naturalness": 87.5,
        "sincerity": 82.1,
        "verbosity": 18.2,
        "repetition": 8.5,
        "readability": 88.7,
        "human_touch": 82.1,
        "emotional_authenticity": 79.3
    },
    "status": "published",
    "created_at": "2025-11-12T10:30:00Z",
    "file_path": "articles/2025-11-12_主题_老金风格.md"
}
```

**Research结果对象 (ResearchResult)**
```python
{
    "topic": "主题",
    "tools_used": [
        {
            "tool": "brave-search",
            "query": "Claude Code 最新功能",
            "success": true,
            "results_count": 10
        }
    ],
    "sources": [
        {
            "url": "https://...",
            "title": "标题",
            "snippet": "摘要",
            "relevance": 0.95
        }
    ],
    "key_findings": [
        "发现1: Claude Code新增MCP支持",
        "发现2: 性能提升60%"
    ],
    "summary": "综合research总结"
}
```

**质量检测结果 (QualityReport)**
```python
{
    "article_id": "uuid",
    "timestamp": "2025-11-12T10:30:00Z",
    "scores": {
        "ai_tone": {"score": 12.3, "passed": true, "threshold": "<20"},
        "naturalness": {"score": 87.5, "passed": true, "threshold": ">80"},
        # ... 其他维度
    },
    "overall_passed": true,
    "issues": [],
    "suggestions": []
}
```

### 4.3 核心API设计

**1. Research API**
```python
def smart_research(topic: str) -> ResearchResult:
    """
    智能research,自动判断需求并调用合适工具

    Args:
        topic: 文章主题

    Returns:
        ResearchResult对象,包含所有收集的信息
    """
    pass
```

**2. 写作API**
```python
def generate_article(
    topic: str,
    research_data: Optional[ResearchResult] = None,
    style: str = "laojin"
) -> Article:
    """
    生成文章,包括正文和标题

    Args:
        topic: 文章主题
        research_data: Research结果(可选)
        style: 写作风格(默认老金风格)

    Returns:
        Article对象
    """
    pass
```

**3. 质量检测API**
```python
def detect_quality(content: str) -> QualityReport:
    """
    8维度质量检测

    Args:
        content: 文章内容

    Returns:
        QualityReport对象
    """
    pass
```

**4. 配图API**
```python
def generate_images(
    topic: str,
    content: str,
    count: int = 3
) -> List[ImageInfo]:
    """
    自动配图

    Args:
        topic: 文章主题
        content: 文章内容
        count: 图片数量

    Returns:
        图片信息列表
    """
    pass
```

**5. 信息图API**
```python
def generate_infographic(
    content: str,
    type: str = "auto"
) -> Optional[InfographicInfo]:
    """
    生成信息图

    Args:
        content: 文章内容
        type: 信息图类型(auto/对比/流程/数据)

    Returns:
        信息图信息对象,如果不适用则返回None
    """
    pass
```

### 4.4 MCP集成架构

**MCP服务器配置 (.mcp.json)**
```json
{
  "mcpServers": {
    "brave-search": {
      "command": "node",
      "args": [".../mcp-brave-search/dist/index.js"],
      "env": {
        "BRAVE_API_KEY": "...",
        "BRAVE_SEARCH_PROXY": "https://127.0.0.1:15236"
      }
    },
    "open-websearch": {
      "command": "npx",
      "args": ["-y", "@open-websearch/mcp-server"],
      "env": {
        "SEARCH1API_KEY": "..."
      }
    },
    "exa": {
      "command": "npx",
      "args": ["-y", "@exa/mcp-server"],
      "env": {
        "EXA_API_KEY": "..."
      }
    },
    "context7": {
      "command": "npx",
      "args": ["-y", "@upstash/context7-mcp-server"],
      "env": {}
    },
    "unsplash": {
      "command": "npx",
      "args": ["-y", "@unsplash/mcp-server"],
      "env": {
        "UNSPLASH_ACCESS_KEY": "..."
      }
    }
  }
}
```

**MCP工具调用优先级策略**
```python
RESEARCH_TOOL_PRIORITY = [
    ("brave-search", "mcp__mcp-router__brave_web_search", {"free_quota": 2000}),
    ("open-websearch", "mcp__mcp-router__search", {"free_quota": "unlimited"}),
    ("exa", "mcp__mcp-router__web_search_exa", {"paid": True}),
    ("context7", "mcp__mcp-router__get_library_docs", {"tech_only": True}),
    ("fallback", "WebSearch", {"built_in": True})
]
```

### 4.5 Hook系统架构

**PreToolUse Hook: research验证**
```bash
# .claude/hooks/pre-tool-use-gongzhonghao-validator.sh
# 功能: 验证research步骤已完成
# 触发: Write/Edit articles目录前
# 失败行为: exit 2 (阻止操作)
```

**PostToolUse Hook: 质量检测**
```bash
# .claude/hooks/post-tool-use-quality-check.sh
# 功能: 运行8维度质量检测
# 触发: Write/Edit articles目录后
# 失败行为: 显示详细报告,不阻止保存
```

**Hook执行器**
```python
class HookExecutor:
    def execute_pre_hook(self, tool_name: str, args: dict) -> bool:
        """执行PreToolUse Hook,返回是否允许继续"""
        pass

    def execute_post_hook(self, tool_name: str, result: Any) -> dict:
        """执行PostToolUse Hook,返回执行结果"""
        pass
```

### 4.6 基础设施需求

**开发环境**:
- Python 3.9+
- Node.js 18+ (MCP服务器)
- Claude Code CLI
- Git

**API依赖**:
- Brave Search API (可选,2000次/月免费)
- Search1API (可选,100次额度)
- Exa API (可选,付费)
- Unsplash API (可选,免费)
- MiniMax API (可选,付费)

**存储需求**:
- articles/ 目录存储文章
- .claude/backups/ 存储备份(10个版本)
- .taskmaster/ 存储任务管理数据

**性能要求**:
- Research < 30秒
- 文章生成 < 60秒
- 质量检测 < 10秒
- 配图生成 < 20秒

## 5. 开发路线图 (Development Roadmap)

### 阶段1: MVP核心流程 (优先级: ⭐⭐⭐⭐⭐)

**目标**: 实现从主题到成稿的基本自动化流程

**范围**:
1. 智能Research系统
   - 主题分析和判断逻辑
   - MCP工具调用(brave-search/open-websearch)
   - 降级策略(MCP失败→WebSearch)
   - Research结果整合

2. 老金风格写作引擎
   - V4风格指南实现
   - 文章结构生成
   - 格式规范自动应用

3. 基础质量检测
   - 8维度检测算法
   - 质量报告生成
   - PostToolUse Hook集成

4. 文件管理
   - 自动命名
   - 自动保存到articles

**验收标准**:
- 用户输入主题,5分钟内生成符合老金风格的文章
- 质量检测一次通过率 > 80%
- Research工具调用成功率 > 90%

### 阶段2: 标题和Hook系统 (优先级: ⭐⭐⭐⭐⭐)

**目标**: 增强文章质量,强化质量保障机制

**范围**:
1. 百万阅读量标题生成器
   - 12大标题公式实现
   - SEO评分算法
   - 爆款指数评估
   - 推荐逻辑

2. Hook验证系统
   - PreToolUse Hook (research验证)
   - PostToolUse Hook升级(10项风格检查)
   - Hook执行器优化

3. 文件组织增强
   - 自动备份(10个版本)
   - 冲突检测和处理

**验收标准**:
- 生成5个高质量标题,推荐准确率 > 85%
- PreToolUse Hook正确阻止未完成research的保存
- 质量检测一次通过率提升到 > 90%

### 阶段3: V4.1视觉增强 (优先级: ⭐⭐⭐⭐)

**目标**: 增加配图和信息图功能,提升视觉吸引力

**范围**:
1. 自动配图系统
   - Unsplash集成
   - MiniMax备选方案
   - 图片自动插入逻辑
   - 配图风格统一

2. 信息图生成系统
   - 文章类型识别(对比/流程/数据)
   - HTML信息图模板
   - Playwright截图
   - 信息图嵌入

**验收标准**:
- 配图生成成功率 > 85%
- 信息图类型识别准确率 > 90%
- 适用文章自动生成信息图成功率 > 80%

### 阶段4: 高级MCP集成 (优先级: ⭐⭐⭐)

**目标**: 完善MCP工具生态,提升research深度

**范围**:
1. 更多MCP工具集成
   - exa深度搜索
   - context7技术文档
   - 其他有价值的MCP服务

2. 智能工具选择
   - 基于主题自动选择最佳工具组合
   - 并行调用优化
   - 结果权重算法

3. Research报告优化
   - 更智能的信息提取
   - 重复内容去重
   - 来源可信度评估

**验收标准**:
- 支持至少5个不同MCP工具
- Research质量显著提升(通过用户反馈)
- 工具选择准确率 > 90%

### 阶段5: 批量和模板系统 (优先级: ⭐⭐⭐)

**目标**: 支持批量创作和自定义模板

**范围**:
1. 批量创作功能
   - 批量主题输入
   - 并行生成文章
   - 批量质量检测

2. 模板系统
   - 自定义风格模板
   - 行业模板(科技/生活/教育等)
   - 模板管理界面

3. 数据分析
   - 文章质量趋势分析
   - Research工具效果分析
   - 用户使用习惯分析

**验收标准**:
- 支持一次性处理10+主题
- 提供至少3个预设模板
- 生成有价值的数据分析报告

### 阶段6: 企业级功能 (优先级: ⭐⭐)

**目标**: 支持团队协作和高级定制

**范围**:
1. 多用户支持
   - 用户管理
   - 权限控制
   - 协作功能

2. API服务
   - RESTful API
   - Webhook通知
   - 第三方集成

3. 性能优化
   - 缓存机制
   - 并发优化
   - 成本控制

**验收标准**:
- 支持多用户同时使用
- API响应时间 < 2秒
- 月度API成本可控在预算内

## 6. 逻辑依赖链 (Logical Dependency Chain)

### 6.1 基础层 (必须最先实现)

**1. 配置和环境**
- MCP服务器配置(.mcp.json)
- API密钥管理(.env)
- 项目目录结构初始化

**2. 核心工具集成**
- MCP Router连接测试
- brave-search/open-websearch基础调用
- WebSearch降级备选方案

**依赖关系**: 无依赖,可最先并行开发

### 6.2 Research层

**3. 主题分析器**
- 关键词识别算法
- 主题类型分类逻辑

**4. Research引擎**
- 多工具调用编排
- 结果整合和去重
- 降级策略实现

**依赖关系**:
- 依赖基础层(1, 2)
- 主题分析器(3) ← Research引擎(4)

### 6.3 内容生成层

**5. 老金风格引擎**
- V4风格指南解析
- 文章结构生成
- 格式规范应用

**6. 标题生成器**
- 12大公式实现
- SEO评分算法
- 推荐逻辑

**依赖关系**:
- 依赖Research层(3, 4)
- 老金风格引擎(5)可独立开发
- 标题生成器(6)依赖老金风格引擎(5)

### 6.4 质量保障层

**7. 质量检测引擎**
- 8维度评分算法
- 质量报告生成

**8. Hook系统**
- PreToolUse Hook
- PostToolUse Hook
- Hook执行器

**依赖关系**:
- 依赖内容生成层(5, 6)
- 质量检测引擎(7)可独立开发
- Hook系统(8)依赖质量检测引擎(7)

### 6.5 文件管理层

**9. 文件组织器**
- 自动命名
- 自动归档
- 自动备份

**依赖关系**:
- 依赖质量保障层(7, 8)

### 6.6 增强功能层

**10. 配图系统**
- Unsplash集成
- MiniMax备选
- 图片插入逻辑

**11. 信息图系统**
- 类型识别
- HTML生成
- Playwright截图

**依赖关系**:
- 依赖文件管理层(9)
- 配图系统(10)和信息图系统(11)可并行开发

### 6.7 完整依赖图

```
         [1. 配置环境]  [2. MCP集成]
                ↓           ↓
         [3. 主题分析] → [4. Research引擎]
                          ↓
                    [5. 老金风格引擎]
                          ↓
                    [6. 标题生成器]
                          ↓
                    [7. 质量检测引擎]
                          ↓
                    [8. Hook系统]
                          ↓
                    [9. 文件组织器]
                          ↓
              [10. 配图系统] [11. 信息图系统]
```

### 6.8 快速可见性策略

**第一个可见里程碑**: 完成1-5模块
- 用户可输入主题
- 可看到research过程
- 可得到完整文章
- **预计时间**: 阶段1完成

**第二个可见里程碑**: 完成1-6模块
- 用户可看到5个爆款标题
- 可选择最佳标题
- **预计时间**: 阶段2前半段

**第三个可见里程碑**: 完成1-8模块
- 用户可看到质量检测报告
- 不通过时可看到具体问题
- **预计时间**: 阶段2完成

**第四个可见里程碑**: 完成1-11模块
- 用户可看到配图后的文章
- 可看到信息图效果
- **预计时间**: 阶段3完成

### 6.9 原子化与渐进增强

**原子化开发单元**:
1. 每个模块可独立测试
2. 每个模块有明确输入输出
3. 模块间通过标准接口交互

**渐进增强策略**:
- 阶段1: 基础可用(MVP)
- 阶段2: 质量提升(标题+Hook)
- 阶段3: 视觉增强(配图+信息图)
- 阶段4+: 深度优化和扩展

## 7. 风险与缓解 (Risks and Mitigations)

### 7.1 技术风险

**风险1: MCP工具调用失败率高**
- 影响: 无法完成research,文章质量下降
- 缓解措施:
  - 实现降级策略(MCP→WebSearch→手动)
  - 增加重试机制(最多3次)
  - 监控各工具成功率,及时切换

**风险2: API配额耗尽**
- 影响: 系统无法正常运行
- 缓解措施:
  - 优先使用免费无限工具(open-websearch)
  - 实现配额监控和预警
  - 提供本地缓存,减少重复调用

**风险3: 质量检测误判**
- 影响: 好文章被拒绝,差文章通过
- 缓解措施:
  - 持续优化评分算法
  - 收集用户反馈调整阈值
  - 提供手动覆盖选项

### 7.2 产品风险

**风险4: 老金风格难以量化**
- 影响: 生成的文章缺乏一致性
- 缓解措施:
  - 建立详细的风格指南
  - 收集大量老金风格文章作为训练数据
  - 持续迭代V4风格引擎

**风险5: 用户期望过高**
- 影响: 自动化程度不够,用户失望
- 缓解措施:
  - 明确传达MVP功能范围
  - 提供详细使用文档
  - 快速迭代,持续改进

### 7.3 资源风险

**风险6: 开发周期过长**
- 影响: 无法快速验证MVP
- 缓解措施:
  - 严格遵循MVP范围
  - 并行开发独立模块
  - 使用现有工具和库,减少重复造轮子

**风险7: API成本失控**
- 影响: 运营成本过高
- 缓解措施:
  - 优先使用免费工具
  - 实现智能缓存
  - 监控单篇文章成本

### 7.4 MVP定义

**MVP核心功能**:
1. ✅ 智能Research(必需)
2. ✅ 老金风格写作(必需)
3. ✅ 基础质量检测(必需)
4. ✅ 自动保存(必需)
5. ❌ 标题生成(可延后)
6. ❌ Hook系统(可延后)
7. ❌ 配图(可延后)
8. ❌ 信息图(可延后)

**MVP验收标准**:
- 用户输入主题 → 5分钟内生成文章
- 文章符合老金风格基本要求
- 质量检测能识别明显问题
- 文章自动保存到articles目录

## 8. 附录 (Appendix)

### 8.1 老金风格详细规范

**核心特征**:
1. 人设: 产品经理,不会代码
2. 语言: 大白话,像和朋友聊天
3. 序号: 1、2、3、(顿号,非点号)
4. 强调: **加粗** (非"引号")
5. 情感: 真实不做作,可用"乖乖""艹"等口语

**禁用词列表**:
- 赋能
- 降本增效
- 闭环
- 抓手
- 颗粒度
- 沉淀
- 赛道
- 生态

**推荐表达**:
- 老金我 (第一人称)
- 咱们 (拉近距离)
- 乖乖 (惊讶)
- 艹 (吐槽)
- SB/憨批 (暴躁老金风格适配)

### 8.2 12大标题公式详解

1. **数字对比型**: "5分钟→5秒,60倍效率提升"
2. **踩坑避雷型**: "千万别xx,难怪xx"
3. **意外发现型**: "我傻了,直到发现xx"
4. **解决方案型**: "这招让你xx"
5. **争议观点型**: "还在xx?你out了"
6. **时间成本型**: "用了半年才发现xx"
7. **场景代入型**: "频繁xx?这招xx"
8. **实测体验型**: "老金测了xx,结果xx"
9. **人群筛选型**: "90%的人不知道xx"
10. **趋势预判型**: "2025年还在xx?"
11. **底层逻辑型**: "为什么xx,因为xx"
12. **资源清单型**: "xx大全,压箱底的都在这"

### 8.3 质量检测算法说明

**AI腔检测算法**:
- 检测禁用词频率
- 检测机械化句式
- 检测过度正式的表达
- 评分: 禁用词数量 × 权重

**自然度算法**:
- 句长变化度
- 口语化词汇比例
- 反问句/感叹句比例
- 评分: 综合加权平均

**人味儿指数算法**:
- 第一人称使用频率
- 情感词汇密度
- 真实案例/数据比例
- 评分: 综合加权平均

### 8.4 MCP工具对比

| 工具 | 免费额度 | 适用场景 | 优先级 |
|------|---------|---------|--------|
| brave-search | 2000次/月 | 深度搜索,技术查询 | ⭐⭐⭐⭐ |
| open-websearch | 无限 | 日常搜索,快速验证 | ⭐⭐⭐⭐⭐ |
| exa | 付费 | 代码相关,深度搜索 | ⭐⭐⭐ |
| context7 | 免费 | 技术文档,官方API | ⭐⭐⭐⭐⭐ |
| unsplash | 免费 | 高质量配图 | ⭐⭐⭐⭐ |
| minimax | 付费 | AI生成图片 | ⭐⭐⭐ |

### 8.5 性能基准

**目标性能指标**:
- Research时间: < 30秒
- 文章生成时间: < 60秒
- 质量检测时间: < 10秒
- 配图生成时间: < 20秒
- 信息图生成时间: < 15秒
- **总计**: < 2分30秒

**优化方向**:
1. 并行化Research工具调用
2. 缓存常见主题的research结果
3. 优化质量检测算法复杂度
4. 预加载常用配图

### 8.6 测试策略

**单元测试**:
- 每个模块独立测试
- 测试覆盖率 > 80%

**集成测试**:
- 测试完整流程
- 测试各种边界情况

**用户测试**:
- 邀请真实用户试用
- 收集反馈优化

**性能测试**:
- 压力测试
- 并发测试
- API调用成本测试

---

**文档版本**: V1.0
**创建日期**: 2025-11-12
**作者**: 老金
**状态**: 待Task Master解析