# Claude Code 检查点功能详解

**发布时间**: 📅 2025年1月4日
**作者**: ✍️ GAC Code Team
**分类**: 基础功能
**标签**: #Claude Code #检查点 #回退 #文件管理

---

自动跟踪和回退Claude的编辑，快速从不需要的更改中恢复。

Claude Code在您工作时自动跟踪Claude的文件编辑，让您能够快速撤销更改并回退到之前的状态，如果任何事情偏离轨道。

### 检查点如何工作

当您与Claude一起工作时，检查点会在每次编辑之前自动捕获您代码的状态。这个安全网让您可以追求雄心勃勃的大规模任务，知道您总是可以返回到之前的代码状态。

#### 自动跟踪

Claude Code跟踪其文件编辑工具所做的所有更改：

- 每个用户提示都会创建一个新的检查点
- 检查点在会话之间持续存在，因此您可以在恢复的对话中访问它们
- 在30天后与会话一起自动清理（可配置）

#### 回退更改

按两次Esc（Esc + Esc）或使用/rewind命令打开回退菜单。您可以选择恢复：

- 仅对话：回退到用户消息同时保留代码更改
- 仅代码：恢复文件更改同时保留对话
- 代码和对话：将两者都恢复到会话中的先前点

### 常见用例

检查点在以下情况下特别有用：

- 探索替代方案：尝试不同的实现方法而不丢失起始点
- 从错误中恢复：快速撤销引入错误或破坏功能的更改
- 功能迭代：实验变化，知道您可以恢复到工作状态

### 限制

#### 不跟踪Bash命令更改

检查点不跟踪由bash命令修改的文件。例如，如果Claude Code运行：

```bash
rm file.txt
mv old.txt new.txt
cp source.txt dest.txt
```

这些文件修改无法通过回退撤销。只有通过Claude的文件编辑工具进行的直接文件编辑才会被跟踪。

#### 不跟踪外部更改

检查点只跟踪在当前会话中已编辑的文件。您在Claude Code之外对文件进行的手动更改以及来自其他并发会话的编辑通常不会被捕获，除非它们恰好修改了与当前会话相同的文件。

#### 不是版本控制的替代品

检查点是为快速的会话级恢复而设计的。对于永久版本历史和协作：

- 继续使用版本控制（例如Git）进行提交、分支和长期历史
- 检查点补充但不替代适当的版本控制
- 将检查点视为”本地撤销”，将Git视为”永久历史”

### 使用技巧

#### 最佳实践

1. 定期确认检查点状态：在进行大规模修改前，检查是否已有最近的检查点
2. 结合版本控制使用：检查点用于快速撤销，Git用于长期版本管理
3. 合理命名会话：清晰的会话名称有助于识别不同检查点的用途

#### 键盘快捷键

- Esc + Esc：打开回退菜单
- /rewind：通过命令方式访问回退功能

### 相关文档

- Claude Code 基础使用 - 基本操作指南
- Claude Code 高级功能 - 更多高级功能介绍
- Claude Code 配置 - 系统配置选项
- Claude Code 安全设置 - 安全相关配置
