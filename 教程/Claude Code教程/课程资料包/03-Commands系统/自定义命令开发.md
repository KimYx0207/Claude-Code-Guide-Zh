# 自定义命令开发指南

## 文档信息

**属性**：版本
**值**：1.0.0


**属性**：更新日期
**值**：2025-12-11


**属性**：适用版本
**值**：Claude Code 1.0+


**属性**：字数
**值**：约12,000字


## 第一章：命令开发基础
### 1.1 自定义命令的本质
Claude Code的自定义命令本质上是**Markdown格式的提示词文件**。当用户输入斜杠命令时，Claude Code会读取对应的Markdown文件，将其作为系统指令注入到对话中。

**核心理念**：
- 提示词即命令（Prompt as Command）
- Markdown即配置（Markdown as Configuration）
- 文件即接口（File as Interface）

**执行流程**：
```
用户输入: /my-command 参数

Claude Code:
1、查找 .claude/commands/my-command.md
2、读取文件内容
3、将"参数"赋值给 $ARGUMENTS
4、执行提示词指令
```

### 1.2 命令文件结构
一个完整的命令文件包含两个部分：YAML前置元数据和Markdown提示词正文。

**基础结构**：
```markdown
name: command-name
description: 命令的一句话描述
version: 1.0.0

# 命令标题

命令的详细说明和执行指令...
```

**YAML前置元数据（Frontmatter）**：
```yaml
name: write               # 命令名称（必需）
description: 公众号文章创作   # 命令描述（推荐）
version: 1.0.0            # 版本号（可选）
author: 老金              # 作者（可选）
tags: [写作, 内容]         # 标签（可选）
```

**元数据字段说明**：


**字段**：name
**必需**：是
**说明**：命令名称，用于 /name 调用


**字段**：description
**必需**：推荐
**说明**：显示在命令列表中的描述


**字段**：version
**必需**：可选
**说明**：版本号，便于管理


**字段**：author
**必需**：可选
**说明**：作者信息


**字段**：tags
**必需**：可选
**说明**：分类标签


### 1.3 $ARGUMENTS参数机制
`$ARGUMENTS`是Claude Code的内置变量，用于接收用户在命令后输入的参数。

**基本用法**：
```markdown
name: greet
description: 问候命令

# 问候命令

请向用户问好，用户的名字是：$ARGUMENTS

如果没有提供名字，使用"朋友"作为默认称呼。
```

**调用示例**：
```
/greet 张三
→ $ARGUMENTS = "张三"

/greet
→ $ARGUMENTS = ""
```

**参数处理技巧**：

**1. 默认值处理**：
```markdown
如果 $ARGUMENTS 为空，使用默认值"Claude Code"。
否则使用用户提供的：$ARGUMENTS
```

**2. 多参数解析**：
```markdown
$ARGUMENTS 格式：[参数1] [参数2] [参数3]

解析规则：
- 第一个参数：主题
- 第二个参数：风格
- 第三个参数：长度

示例：/write AI工具 技术 3000字
```

**3. 可选参数**：
```markdown
参数说明：
$ARGUMENTS 格式：<必需参数> [可选参数]

- 必需：主题（第一个词）
- 可选：--style=formal（风格修饰符）
```

### 1.4 工具调用语法
自定义命令可以调用Claude Code的所有内置工具和MCP工具。

**内置工具调用**：
```markdown
## 执行步骤
### 步骤1：读取文件
使用Read工具读取配置文件：
```
Read(".claude/settings.json")
```

### 步骤2：搜索内容
使用Grep搜索特定模式：
```
Grep("TODO", path="src/", type="py")
```

### 步骤3：执行命令
使用Bash执行系统命令：
```bash
npm run build
```
```

**MCP工具调用**：
```markdown
## MCP工具使用
### 搜索信息
```
mcp__mcp-router__search(
    query="$ARGUMENTS",
    search_service="google",
    max_results=10
)
```

### 读取文档
```
mcp__context7__get_library_docs(
    context7CompatibleLibraryID="/facebook/react",
    topic="hooks"
)
```
```

**工具调用最佳实践**：

1、**明确工具选择**：说明为什么选择这个工具
2、**参数完整性**：提供所有必需参数
3、**错误处理**：说明失败时的备选方案
4、**结果使用**：说明如何处理工具返回的结果


## 第二章：高级开发技巧
### 2.1 条件逻辑实现
虽然Markdown本身不支持编程逻辑，但通过精心设计的提示词，可以实现类似条件分支的效果。

**IF-ELSE模式**：
```markdown
## 执行逻辑
根据 $ARGUMENTS 的内容判断执行路径：

**情况1：参数包含"深度"或"详细"**
→ 执行深度分析流程
→ 输出完整报告（3000字以上）
→ 包含数据图表

**情况2：参数包含"快速"或"简要"**
→ 执行快速分析
→ 输出简要报告（500字以内）
→ 只包含关键结论

**情况3：其他情况（默认）**
→ 执行标准分析
→ 输出标准报告（1500字）
→ 包含主要发现和建议
```

**SWITCH-CASE模式**：
```markdown
## 类型判断
检查 $ARGUMENTS 的第一个关键词，确定文章类型：


**关键词**："测评"
**文章类型**：测评类
**使用模板**：templates/review.md


**关键词**："教程"
**文章类型**：教程类
**使用模板**：templates/tutorial.md


**关键词**："降价"
**文章类型**：降价类
**使用模板**：templates/discount.md


**关键词**："对比"
**文章类型**：对比类
**使用模板**：templates/comparison.md


**关键词**：其他
**文章类型**：通用类
**使用模板**：templates/general.md


根据判断结果，加载对应模板。
```

**复合条件**：
```markdown
## 复合判断
同时检查以下条件：

**条件A**：$ARGUMENTS 是否包含品牌词（Claude/Cursor/GPT）
**条件B**：$ARGUMENTS 是否包含时效词（最新/刚发布/更新）

判断结果：
- A=true, B=true → 热点测评文章（紧急度高）
- A=true, B=false → 常规工具文章（标准流程）
- A=false, B=true → 行业热点文章（快速产出）
- A=false, B=false → 观点输出文章（可以慢工出细活）
```

### 2.2 循环处理实现
循环处理同样通过提示词设计来实现。

**列表遍历模式**：
```markdown
## 批量处理
对以下列表中的每一项执行处理：

$ARGUMENTS 包含多个文件路径，用空格分隔。

**处理流程**：
1、将 $ARGUMENTS 按空格分割为文件列表
2、对每个文件执行以下操作：
   a. 读取文件内容
   b. 分析文件质量
   c. 生成改进建议
   d. 记录结果
3、所有文件处理完成后，生成汇总报告

**输出格式**：
```
文件1: [文件名]
  - 问题数: X
  - 建议: ...

文件2: [文件名]
  - 问题数: X
  - 建议: ...

汇总: 共处理X个文件，发现Y个问题
```
```

**迭代优化模式**：
```markdown
## 迭代改进流程
执行最多3轮优化迭代：

**第1轮：基础检查**
1、执行质量检测
2、记录不通过项
3、如果全部通过 → 结束
4、如果有不通过 → 继续第2轮

**第2轮：针对性修复**
1、针对第1轮发现的问题进行修复
2、重新执行质量检测
3、如果全部通过 → 结束
4、如果仍有不通过 → 继续第3轮

**第3轮：深度优化**
1、进行更大幅度的修改
2、最终质量检测
3、输出最终结果（无论是否通过）

**迭代规则**：
- 每轮修改不超过总内容的30%
- 保持核心信息不变
- 记录每轮的修改内容
```

### 2.3 错误处理设计
健壮的命令需要考虑各种错误场景。

**输入验证**：
```markdown
## 输入验证
在执行主流程前，先验证输入：

**检查1：参数是否为空**
- 如果 $ARGUMENTS 为空
- 提示用户：请提供主题，格式：/command [主题]
- 终止执行

**检查2：参数格式是否正确**
- 如果参数不符合预期格式
- 显示正确的使用方法
- 提供示例

**检查3：依赖文件是否存在**
- 检查必需的配置文件
- 如果缺失，提示用户创建或提供默认值
```

**工具调用错误处理**：
```markdown
## 错误处理
### MCP工具调用
尝试调用搜索工具：
```
mcp__mcp-router__search(query="$ARGUMENTS")
```

**如果调用成功**：
→ 继续处理搜索结果
→ 执行后续步骤

**如果调用失败**：
→ 记录错误信息
→ 尝试备选工具：WebSearch
→ 如果备选也失败，使用内置知识继续

**错误类型处理**：
- 401/403错误：API密钥问题，提示用户检查配置
- 超时错误：网络问题，建议稍后重试
- 工具不存在：MCP未配置，提供配置指南
```

**优雅降级**：
```markdown
## 降级策略
本命令有3个功能级别：

**完整功能**（需要MCP工具）：
- 实时搜索最新信息
- 深度数据分析
- 自动生成图表

**标准功能**（需要网络）：
- 使用WebSearch获取信息
- 基础数据分析
- 文本报告

**离线功能**（最低要求）：
- 使用内置知识
- 模板化输出
- 基本建议

自动检测可用资源，选择最高可用级别执行。
```

### 2.4 模块化设计
将复杂命令拆分为可复用的模块。

**模块引用**：
```markdown
## 模块加载
本命令依赖以下模块：

### 必需模块
执行前必须加载：
```
Read(".claude/skills/gongzhonghao-writer/prompts/laojin-style-v6-natural.md")
Read(".claude/skills/gongzhonghao-writer/prompts/baokuan-rules.md")
```

### 可选模块
根据需要加载：
```
如果是对比类文章：
Read(".claude/skills/gongzhonghao-writer/templates/comparison.md")

如果是教程类文章：
Read(".claude/skills/gongzhonghao-writer/templates/tutorial.md")
```
```

**脚本调用**：
```markdown
## 脚本模块
### 质量检测模块
调用Python脚本进行质量检测：
```bash
cd ".claude/skills/gongzhonghao-writer/scripts"
python quality_detector.py "[文章路径]"
```

### 标题生成模块
调用标题生成器：
```bash
cd ".claude/skills/gongzhonghao-writer/scripts"
python title_generator.py "$ARGUMENTS" --full
```

### 标题评分模块
调用标题评分器：
```bash
cd ".claude/skills/gongzhonghao-writer/scripts"
python title_scorer.py "[标题]"
```
```


## 第三章：典型命令模式
### 3.1 搜索增强命令
**场景**：增强搜索能力，整合多数据源。

**示例：热点扫描命令**
```markdown
name: hotspot
description: AI热点自动扫描 - 抓取今日AI热点并评估爆款潜力
version: 7.0.0

# 热点自动扫描系统

## 执行流程
### 第一轮：多源并行扫描
同时调用以下5个搜索工具：

**1. GitHub热榜**
```
mcp__mcp-router__trending(
    search_service="github",
    max_results=20
)
```

**2. HackerNews热榜**
```
mcp__mcp-router__trending(
    search_service="hackernews",
    max_results=20
)
```

**3. Twitter/X搜索**
```
mcp__mcp-router__search(
    query="AI release OR AI update OR Claude OR GPT",
    search_service="x",
    max_results=20,
    time_range="day"
)
```

**4. Reddit搜索**
```
mcp__mcp-router__search(
    query="AI LocalLLaMA MachineLearning",
    search_service="reddit",
    max_results=20
)
```

**5. 新闻搜索**
```
mcp__mcp-router__news(
    query="AI 大模型 Claude GPT",
    search_service="google",
    max_results=20,
    time_range="day"
)
```

### 第二轮：结果筛选
**筛选规则**：

**来源**：GitHub
**保留标准**：Stars>100 或 今日新增>50


**来源**：HackerNews
**保留标准**：评论>50 或 点数>100


**来源**：Twitter
**保留标准**：来自KOL 或 互动>100


**来源**：Reddit
**保留标准**：评论>20


**来源**：新闻
**保留标准**：24小时内


### 第三轮：爆款评估
对每个热点进行5维度评分（满分25分）：
- 时效性（1-5分）
- 来源可信度（1-5分）
- 受众面（1-5分）
- 实用性（1-5分）
- 情绪点（1-5分）

### 输出格式
```
╔════════════════════════════════════════════╗
║         今日AI热点扫描报告                  ║
╚════════════════════════════════════════════╝

🔥🔥🔥 必写热点（23-25分）
────────────────────────
【热点1】标题
├─ 来源：平台 | 可信度：S级
├─ 评分：24/25分
└─ 推荐理由：...

🔥🔥 强烈推荐（18-22分）
────────────────────────
...
```
```

### 3.2 文件处理命令
**场景**：批量处理文件，执行分析或转换。

**示例：数据收集命令**
```markdown
name: data-collect
description: 微信公众号数据自动收集与分析
version: 2.0.0

# 数据收集系统

## 前置检查
### 检查1：Chrome调试端口
```bash
curl -s http://localhost:9222/json/version
```
- 如果成功 → 继续
- 如果失败 → 提示启动Chrome调试模式

### 检查2：数据文件
```bash
ls data/temp/page*_snapshot.txt
```
- 如果存在 → 继续
- 如果不存在 → 提示准备数据

## 执行流程
### 步骤1：运行收集脚本
```bash
cd ".claude/skills/gongzhonghao-writer/scripts"
python collect_time_range.py --days 30
```

### 步骤2：运行分析脚本
```bash
cd ".claude/skills/gongzhonghao-writer/scripts"
python analyze_wechat_data.py "data/wechat_articles.json"
```

### 步骤3：创建报告目录
```bash
mkdir -p "data/$(date +%Y-%m-%d)_数据分析"
```

### 步骤4：保存报告
```bash
cp wechat_report.txt "data/$(date +%Y-%m-%d)_数据分析/"
cp analysis_report.json "data/$(date +%Y-%m-%d)_数据分析/"
```

## 输出展示
向用户展示：
- 收集文章数量
- 新增/更新数量
- 爆款文章TOP 3
- 关键发现
- 报告文件路径
```

### 3.3 数据分析命令
**场景**：对收集的数据进行深度分析。

**示例：数据分析命令**
```markdown
name: data-analyze
description: 微信公众号数据深度分析 - 科学统计版
version: 7.1.0

# 数据深度分析系统

## 分析方法（V7.0科学统计）
### 1. 爆款阈值定义
使用IQR方法替代硬编码：
- P75（推荐）：75分位数阈值
- P90（宽松）：90分位数阈值
- IQR（严格）：Q3 + 1.5 * IQR

### 2. 关键词提取
使用TF-IDF智能提取：
- sklearn TF-IDF向量化
- jieba中文分词
- Top 10关键词输出

### 3. 统计检验
- t-test比较爆款vs普通文章
- Cohen's d效应量
- 95%置信区间

## 执行流程
### 步骤1：验证数据
```bash
ls ".claude/skills/gongzhonghao-writer/data/wechat_articles.json"
```

### 步骤2：运行分析
```bash
cd ".claude/skills/gongzhonghao-writer/scripts"
python analyze_wechat_data.py
```

### 步骤3：读取报告
```
Read("analysis_report.json")
```

## 输出格式
```markdown
## 数据分析报告 V7.0
### 一、样本量检查
- 文章总数：X篇
- 状态：✅/⚠️

### 二、爆款阈值
- Q1: X | Q3: Y | IQR: Z
- 推荐阈值（P75）：W

### 三、TF-IDF关键词
1、关键词A (0.85)
2、关键词B (0.72)
...

### 四、统计检验
- t统计量：X
- p值：Y
- 效应量：Z（小/中/大）

### 五、策略建议
...
```

## 数据同步提醒
分析完成后，提醒更新以下文件：
- prompts/baokuan-rules.md
- scripts/title_scorer.py
- scripts/title_generator.py
- commands/01-write.md
```

### 3.4 代码生成命令
**场景**：自动生成代码或配置文件。

**示例：信息图生成命令**
```markdown
name: infographic
description: 自动生成精美信息图
version: 7.0.0

# 信息图生成系统

## 适用场景判断
检查 $ARGUMENTS（文章路径）的内容：

**生成对比表格**（如果包含）：
- "vs"、"对比"、"比较"

**生成流程图**（如果包含）：
- "步骤"、"流程"、"安装"

**生成数据卡片**（如果包含）：
- 百分比、价格数据

**不生成**（如果是）：
- 纯观点文章
- 短文章（<1000字）

## 执行流程
### 步骤1：读取文章
```
Read("$ARGUMENTS")
```

### 步骤2：分析类型
根据上述规则判断信息图类型

### 步骤3：提取数据
- 对比表格：提取对比维度和结果
- 流程图：提取步骤标题和描述
- 数据卡片：提取关键数字

### 步骤4：生成HTML
使用模板生成信息图HTML：
```
Write("infographics/[name].html", [生成的HTML内容])
```

### 步骤5：截图
```
mcp__Playwright__browser_navigate(url="file:///[HTML路径]")
mcp__Playwright__browser_take_screenshot(filename="infographic.png")
```

### 步骤6：插入文章
在文章合适位置插入图片引用

## HTML模板
对比表格模板：
```html
<div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px; border-radius: 15px; color: white;">
  <h2>$TITLE</h2>
  <table>
    <tr>
      <th>维度</th>
      <th>$ITEM1</th>
      <th>$ITEM2</th>
    </tr>
    <!-- 数据行 -->
  </table>
</div>
```
```


## 第四章：实战案例分析
### 4.1 项目命令概览
本项目（公众号写作助手）包含20个自定义命令，按功能分组编号：


**编号段**：00
**分类**：帮助
**命令数量**：1个


**编号段**：01-03
**分类**：写作
**命令数量**：3个


**编号段**：11-12
**分类**：热点
**命令数量**：2个


**编号段**：21-24
**分类**：标题/检查
**命令数量**：4个


**编号段**：31-32
**分类**：图片
**命令数量**：2个


**编号段**：41-42
**分类**：数据
**命令数量**：2个


**编号段**：91-92
**分类**：工具
**命令数量**：2个


**编号段**：其他
**分类**：TaskMaster
**命令数量**：4个


### 4.2 核心命令分析
#### /write - 完整写作流程
**文件位置**：`.claude/commands/01-write.md`

**设计特点**：
1、**8步完整流程**：选题过滤 → 读取规范 → 智能判断 → Research → 创作 → 标题生成 → 保存 → 质量检测
2、**模块化调用**：调用统一的脚本模块
3、**条件分支**：根据主题自动判断是否需要Research
4、**质量保障**：自动运行质量检测

**关键代码段**：
```markdown
### 步骤5：自动生成爆款标题
**调用标题生成器脚本**（V7.2模块化）：
```bash
cd ".claude/skills/gongzhonghao-writer/scripts" && python title_generator.py "{主题关键词}" --full
```
```

**设计启示**：
- 将可复用功能封装为脚本
- 命令只负责流程编排
- 通过脚本统一输出格式

#### /topic-filter - 选题过滤器
**文件位置**：`.claude/commands/24-topic-filter.md`

**设计特点**：
1、**双轨分类**：核心工具类 vs 泛AI话题类
2、**时效性预检**：WebSearch确认产品发布时间
3、**数据驱动**：基于82篇历史数据的分类标准

**关键代码段**：
```markdown
### 步骤1：产品时效性预检
**如果选题涉及具体产品名称**，先用WebSearch搜索确认：
```
搜索：[产品名] 发布时间 release date
```

判断逻辑：
- 一个月内发布 → 热点期
- 一个月以上 → 常青期
```

**设计启示**：
- 命令可以调用其他命令（WebSearch）
- 判断逻辑要明确且可执行
- 输出要包含决策依据

#### /write-auto - 全自动爆款生成
**文件位置**：`.claude/commands/02-write-auto.md`

**设计特点**：
1、**零干预流程**：从热点到成稿全自动
2、**类型自适应**：根据热点特征选择模板
3、**自动配图**：根据文章长度决定配图数量

**关键代码段**：
```markdown
### 步骤2：选题类型判断
判断规则：
```
IF 热点包含 "发布/更新/上线/新版" → 测评类
ELSE IF 热点包含 "降价/优惠/折扣" → 降价类
ELSE → 经验故事类
```
```

**设计启示**：
- 使用伪代码表达复杂逻辑
- 提供明确的判断规则
- 每个分支都有对应处理

#### /ai-orchestrator - 多AI编排
**文件位置**：`.claude/commands/92-ai-orchestrator.md`

**设计特点**：
1、**多引擎协作**：Claude + Codex + Gemini
2、**阶段化执行**：需求分析 → 代码生成 → 代码审查
3、**结果合并**：生成综合报告

**关键代码段**：
```markdown
## 工作流程
1、**阶段1 - 需求分析**（第一个引擎）
2、**阶段2 - 代码生成**（第二个引擎）
3、**阶段3 - 代码审查**（第三个引擎）

**步骤2**: 调用编排脚本
```bash
bash .claude/skills/ai-orchestrator/scripts/orchestrate.sh \
    "." "$TASK_DESC" "$ENGINE1" "$ENGINE2" "$ENGINE3"
```
```

**设计启示**：
- 复杂逻辑可以委托给外部脚本
- 命令提供友好的接口
- 输出结构化的结果

### 4.3 命令设计模式总结
**模式1：流程编排型**
- 特点：步骤清晰、顺序执行
- 代表：/write、/daily
- 适用：复杂工作流

**模式2：类型判断型**
- 特点：根据输入选择分支
- 代表：/topic-filter、/write-auto
- 适用：多场景适配

**模式3：工具集成型**
- 特点：整合多个工具
- 代表：/hotspot、/test-mcp
- 适用：数据聚合

**模式4：质量保障型**
- 特点：检测+反馈+修复
- 代表：/pre-check、/title-score
- 适用：质量控制


## 第五章：实战练习
### 5.1 练习一：创建第一个命令
**目标**：创建一个简单的问候命令

**步骤**：

1、**创建命令文件**
```bash
# 创建 .claude/commands/hello.md
```

2、**编写命令内容**
```markdown
name: hello
description: 友好问候命令
version: 1.0.0

# 问候命令

你好！我是你的AI助手。

你的名字是：$ARGUMENTS

如果没有提供名字，我会称呼你为"朋友"。

请用友好的方式问候用户，并询问今天可以帮助什么。
```

3、**测试命令**
```
/hello 张三
/hello
```

4、**验证结果**
- 有参数时应该使用提供的名字
- 无参数时应该使用"朋友"

### 5.2 练习二：创建搜索命令
**目标**：创建一个技术文档搜索命令

**步骤**：

1、**创建命令文件**
```bash
# 创建 .claude/commands/tech-search.md
```

2、**编写命令内容**
```markdown
name: tech-search
description: 技术文档搜索
version: 1.0.0

# 技术文档搜索

## 参数
搜索关键词：$ARGUMENTS

## 执行流程
### 步骤1：搜索官方文档
使用Context7查询技术文档：
```
mcp__context7__resolve_library_id(libraryName="$ARGUMENTS")
```

### 步骤2：搜索最新信息
```
WebSearch(query="$ARGUMENTS 官方文档 教程 2025")
```

### 步骤3：整合输出
将搜索结果整合为结构化报告：
- 官方文档链接
- 关键概念
- 快速入门步骤
- 常见问题
```

3、**测试命令**
```
/tech-search FastAPI
/tech-search React hooks
```

### 5.3 练习三：创建质量检查命令
**目标**：创建一个文件质量检查命令

**步骤**：

1、**创建命令文件**
```bash
# 创建 .claude/commands/check-quality.md
```

2、**编写命令内容**
```markdown
name: check-quality
description: 代码/文档质量检查
version: 1.0.0

# 质量检查命令

## 参数
检查目标：$ARGUMENTS

## 执行流程
### 步骤1：确定文件类型
根据文件扩展名确定检查策略：
- .py → Python代码检查
- .md → Markdown文档检查
- .js/.ts → JavaScript/TypeScript检查
- 其他 → 通用检查

### 步骤2：读取文件
```
Read("$ARGUMENTS")
```

### 步骤3：执行检查
**Python代码检查维度**：
- 类型注解完整性
- 文档字符串
- 函数长度
- 命名规范

**Markdown文档检查维度**：
- 标题层级
- 链接有效性
- 格式一致性
- 拼写检查

### 步骤4：输出报告
```
质量检查报告：$ARGUMENTS
============================
总体评分：X/100

✅ 通过项：
- ...

❌ 问题项：
- ...

💡 改进建议：
- ...
```
```

3、**测试命令**
```
/check-quality src/main.py
/check-quality README.md
```

### 5.4 练习四：创建工作流命令
**目标**：创建一个整合多个步骤的工作流命令

**步骤**：

1、**创建命令文件**
```bash
# 创建 .claude/commands/morning-routine.md
```

2、**编写命令内容**
```markdown
name: morning-routine
description: 每日早间例行检查
version: 1.0.0

# 早间例行检查

## 执行流程
### 步骤1：项目状态检查
```bash
git status
```
输出：未提交的更改、当前分支

### 步骤2：待办事项
列出TODO注释：
```
Grep("TODO|FIXME", path="src/", type="all")
```

### 步骤3：热点扫描（可选）
如果 $ARGUMENTS 包含 "热点"：
```
调用 /hotspot 命令
```

### 步骤4：生成早报
```
早间例行报告
================
日期：[今日日期]

📁 项目状态
- 当前分支：xxx
- 未提交更改：X个文件

📝 待办事项
- TODO 1: ...
- TODO 2: ...

🔥 今日热点（如有）
- ...

💡 今日建议
- ...
```
```

3、**测试命令**
```
/morning-routine
/morning-routine 热点
```

### 5.5 练习五：改进现有命令
**目标**：改进一个现有命令，添加新功能

**选择一个命令进行改进**，例如：

**改进 /title-gen 命令**：
1、添加行业参数支持
2、添加风格选择（正式/口语）
3、添加历史标题参考

**改进步骤**：
1、读取现有命令
2、分析可改进点
3、设计新功能
4、实现并测试
5、记录改动


## 第六章：最佳实践总结
### 6.1 命令设计原则
**1. 单一职责**
- 每个命令只做一件事
- 复杂功能拆分为多个命令
- 通过组合实现复杂流程

**2. 清晰的输入输出**
- 明确参数格式
- 提供使用示例
- 结构化输出结果

**3. 健壮的错误处理**
- 验证输入有效性
- 提供有意义的错误信息
- 支持优雅降级

**4. 可复用性**
- 提取通用逻辑为模块
- 使用参数化设计
- 避免硬编码

### 6.2 命名规范
**命令名称**：
- 使用小写字母和连字符
- 动词+名词格式优先
- 保持简洁但有意义

**示例**：
```
✅ /title-gen
✅ /data-analyze
✅ /pre-check

❌ /titleGenerator
❌ /DataAnalyze
❌ /pc
```

**编号规范**：
- 00-09：帮助/通用
- 10-19：核心功能A
- 20-29：核心功能B
- 90-99：工具/测试

### 6.3 文档规范
**必备章节**：
1、功能说明
2、使用方法
3、参数说明
4、执行流程
5、输出格式
6、常见问题

**示例模板**：
```markdown
name: command-name
description: 一句话描述
version: 1.0.0

# 命令标题

**功能**：详细说明

**使用方法**：
```
/command-name [参数]
```

**示例**：
```
/command-name example
```

## 执行流程
### 步骤1：...
### 步骤2：...
## 输出格式
```
输出示例
```

## 常见问题
**Q1: 问题1？**
A: 答案1

**Q2: 问题2？**
A: 答案2
```

### 6.4 测试与维护
**测试清单**：
- [ ] 正常参数测试
- [ ] 空参数测试
- [ ] 异常参数测试
- [ ] 依赖缺失测试
- [ ] 边界条件测试

**维护建议**：
1、定期检查命令有效性
2、及时更新依赖版本
3、记录变更日志
4、收集用户反馈


## 附录A：命令模板库
### 基础模板
```markdown
name: template-basic
description: 基础命令模板
version: 1.0.0

# 命令名称

## 参数
$ARGUMENTS

## 执行
[执行逻辑]

## 输出
[输出格式]
```

### 搜索模板
```markdown
name: template-search
description: 搜索命令模板
version: 1.0.0

# 搜索命令

## 搜索参数
关键词：$ARGUMENTS

## 搜索源
### 源1
```
mcp__xxx__search(query="$ARGUMENTS")
```

### 源2
```
WebSearch(query="$ARGUMENTS")
```

## 结果整合
[整合逻辑]

## 输出格式
```
搜索结果：$ARGUMENTS
====================
[结果列表]
```
```

### 处理模板
```markdown
name: template-process
description: 处理命令模板
version: 1.0.0

# 处理命令

## 输入
目标：$ARGUMENTS

## 前置检查
### 检查1：输入有效性
[检查逻辑]

### 检查2：依赖可用性
[检查逻辑]

## 处理流程
### 步骤1：读取
```
Read("$ARGUMENTS")
```

### 步骤2：处理
[处理逻辑]

### 步骤3：输出
```
Write("[输出路径]", [内容])
```

## 结果
[结果展示]
```

### 工作流模板
```markdown
name: template-workflow
description: 工作流命令模板
version: 1.0.0

# 工作流命令

## 阶段1：准备
[准备步骤]

## 阶段2：执行
[执行步骤]

## 阶段3：验证
[验证步骤]

## 阶段4：输出
[输出步骤]

## 错误处理
**如果阶段X失败**：
[处理方案]
```


## 附录B：常见问题解答
**Q1: 命令文件放在哪里？**
A: 放在 `.claude/commands/` 目录下，文件名即命令名。

**Q2: 如何传递多个参数？**
A: 所有参数都在 `$ARGUMENTS` 中，用空格分隔，在命令中解析。

**Q3: 命令可以调用其他命令吗？**
A: 可以，在提示词中说明调用哪个命令即可。

**Q4: 如何调试命令？**
A: 检查输出是否符合预期，使用简单测试用例验证。

**Q5: 命令执行出错怎么办？**
A: 检查工具可用性、参数格式、网络连接等。

**Q6: 如何让命令在所有项目可用？**
A: 放在 `~/.claude/commands/` 目录下（用户级）。

**Q7: 命令支持中文名吗？**
A: 技术上支持，但建议使用英文命名，中文放在description中。

**Q8: 如何隐藏敏感信息？**
A: 敏感信息放在环境变量中，命令中通过变量引用。


**文档结束**

本指南覆盖了Claude Code自定义命令开发的完整知识体系，从基础语法到高级技巧，从设计模式到实战案例。建议读者按顺序学习，并通过练习巩固所学内容。

持续改进您的命令，让它们成为真正高效的生产力工具。
