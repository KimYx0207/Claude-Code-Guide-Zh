# 公众号写作助手 Web GUI - 环境变量配置

## 🚀 快速开始（免费版）

如果您不配置任何API密钥，系统会使用**免费方案**：
- ✅ 热点扫描 → GitHub API（免费，无需密钥）
- ✅ 自动写作 → 固定模板生成
- ✅ 完整写作 → 固定教程模板
- ✅ 文章翻新 → 简单提取改写

**免费版已经可以使用！** 直接运行 `npm run dev` 即可。

---

## 🔑 API密钥配置（可选升级）

如果您想使用**AI智能生成**（更自然、更真实），可以配置以下API密钥：

### 1. 创建 .env.local 文件

在 `web-app/frontend/` 目录下创建 `.env.local` 文件（已在 .gitignore 中）：

```bash
cd web-app/frontend
touch .env.local
```

### 2. 配置API密钥

根据您的需求，选择以下一种或多种：

#### 方案A：OpenAI（推荐，功能最强）
```bash
OPENAI_API_KEY=sk-your-openai-api-key-here
```

**获取方式**：
1. 访问 https://platform.openai.com/api-keys
2. 注册/登录账号
3. 创建新的API Key
4. 复制粘贴到上面

**价格参考**：
- GPT-4：$0.03/1K tokens（生成一篇2000字文章约$0.20）
- GPT-3.5-Turbo：$0.002/1K tokens（便宜10倍）

#### 方案B：Claude（备选）
```bash
ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key-here
```

**获取方式**：
1. 访问 https://console.anthropic.com/
2. 注册/登录账号
3. 创建API Key
4. 复制粘贴到上面

**价格参考**：
- Claude Sonnet：$0.003/1K tokens（生成一篇2000字文章约$0.25）

#### 方案C：Tavily搜索（可选，增强热点扫描）
```bash
TAVILY_API_KEY=tvly-your-tavily-api-key-here
```

**获取方式**：
1. 访问 https://tavily.com/
2. 注册账号
3. 获取API Key

**价格参考**：
- 免费版：每月1000次搜索
- 付费版：$49/月（无限制）

**注意**：不配置此密钥时，热点扫描会使用免费的GitHub API。

---

## 📊 功能对照表

| 功能 | 免费版 | OpenAI版 | Claude版 |
|------|--------|---------|---------|
| **热点扫描** | ✅ GitHub API | ✅ GitHub + Tavily | ✅ GitHub + Tavily |
| **自动写作** | ⚠️ 固定模板 | ✅ AI智能生成 | ✅ AI智能生成 |
| **完整写作** | ⚠️ 固定模板 | ✅ 深度教程生成 | ✅ 深度教程生成 |
| **文章翻新** | ⚠️ 简单提取 | ✅ 深度改写 | ✅ 深度改写 |
| **标题生成** | ✅ Python脚本 | ✅ Python脚本 | ✅ Python脚本 |
| **标题评分** | ✅ Python脚本 | ✅ Python脚本 | ✅ Python脚本 |
| **质量检测** | ✅ Python脚本 | ✅ Python脚本 | ✅ Python脚本 |

---

## 🎯 推荐配置方案

### 方案1：完全免费
```bash
# 不需要配置任何密钥
# 直接运行 npm run dev
```
**适合**：测试、学习、个人使用

### 方案2：基础AI增强
```bash
OPENAI_API_KEY=sk-xxx  # 只配置OpenAI
```
**适合**：小规模使用，偶尔生成文章

### 方案3：完整AI能力
```bash
OPENAI_API_KEY=sk-xxx
TAVILY_API_KEY=tvly-xxx
```
**适合**：专业用户，大量生成高质量文章

### 方案4：备选方案
```bash
ANTHROPIC_API_KEY=sk-ant-xxx  # 用Claude代替OpenAI
```
**适合**：已有Claude账号的用户

---

## 🔧 配置验证

配置完成后，重启开发服务器：

```bash
# 停止当前服务器（Ctrl+C）
# 重新启动
cd web-app/frontend
npm run dev
```

打开浏览器访问 http://localhost:3000，测试功能：

1. **热点扫描** - 应该能看到真实的AI热点
2. **自动写作** - 查看返回的 `strategy` 字段：
   - `"固定模板（免费）"` = 未配置密钥
   - `"OpenAI GPT-4"` = 已配置OpenAI
   - `"Claude Sonnet"` = 已配置Claude

---

## 🛡️ 安全提醒

⚠️ **重要**：
1. **永远不要把 `.env.local` 提交到Git**（已在 .gitignore 中）
2. **不要分享你的API密钥**
3. **定期轮换密钥**（每3个月）
4. **监控API使用量**（避免超额费用）

---

## 💰 成本估算

假设每天生成10篇文章（每篇2000字）：

| 方案 | 月成本 | 说明 |
|------|--------|------|
| 免费版 | $0 | 完全免费 |
| OpenAI GPT-3.5 | ~$1.20 | 每篇$0.004 × 10篇 × 30天 |
| OpenAI GPT-4 | ~$60 | 每篇$0.20 × 10篇 × 30天 |
| Claude Sonnet | ~$75 | 每篇$0.25 × 10篇 × 30天 |
| Tavily搜索 | $49/月 | 或免费版（1000次/月） |

**老金建议**：
- 测试阶段用免费版
- 小规模使用GPT-3.5（便宜）
- 大规模使用时评估GPT-4 vs Claude

---

## ❓ 常见问题

### Q1: 我配置了密钥，但还是用的免费版？
A: 检查以下事项：
1. `.env.local` 文件是否在 `web-app/frontend/` 目录下
2. 密钥格式是否正确（`OPENAI_API_KEY=sk-xxx`）
3. 是否重启了开发服务器
4. 查看浏览器控制台或终端日志，看是否有错误

### Q2: API调用失败怎么办？
A: 可能原因：
1. **密钥无效** - 检查密钥是否过期或输入错误
2. **余额不足** - 检查OpenAI/Claude账户余额
3. **网络问题** - 检查能否访问API服务器
4. **请求超限** - 等待几分钟后重试

### Q3: 能同时配置多个密钥吗？
A: 可以！系统会按优先级使用：
- 写作功能：OpenAI > Claude > 免费模板
- 搜索功能：Tavily > GitHub API（免费）

### Q4: 免费版够用吗？
A: 看使用场景：
- ✅ 学习测试：完全够用
- ✅ 偶尔写作：可以用（但质量一般）
- ❌ 批量生产：建议升级AI版

---

## 📞 获取帮助

如遇问题，请提供以下信息：
- 系统环境（操作系统、Node.js版本）
- 错误日志（控制台输出）
- 配置情况（不要泄露密钥）

---

**最后**：配置是可选的！免费版已经能用，先试试再决定是否升级。
