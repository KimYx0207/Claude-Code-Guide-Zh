---
name: write
description: 📝 公众号文章全自动创作系统 - 一键生成高质量老金风格文章
version: 9.0.0
---

# 🚀 公众号文章全自动创作系统 V9.0

**版本**：V9.0 | **更新日期**：2025-12-20

**一条命令，自动完成全部流程！**

用户输入主题 → 自动Research → 自动创作 → 可选配图 → 自动质量检测 → 自动保存

---

## 🔥 **全自动化命令系统**

**不知道写什么？用这些命令实现完全自动化！**

| 命令 | 功能 | 使用场景 |
|------|------|---------|
| `/hotspot` | 🔥 热点自动扫描 | 不知道写什么，想找今天的热点 |
| `/write-auto [关键词]` | 🚀 一键爆款生成 | 已知热点，一键生成完整文章 |
| `/daily` | 📅 每日扫描+自动写作 | 每天例行内容生产，全自动 |
| `/write [主题]` | 📝 传统完整流程 | 自定义主题，需要更多控制 |

**推荐工作流**：
```
1、每天早上运行 /daily → 自动扫描热点 + 自动生成文章
2、或者运行 /hotspot → 查看热点报告 → 选一个 /write-auto [关键词]
3、有特定主题时用 /write [主题]
```

---

## 🖼️ **智能配图系统（可选功能）**

**📸 配图说明：**
- 文章保存后，可运行 `/image` 命令自动添加2-4张高质量配图
- 优先使用Unsplash无版权图片，备选MiniMax AI生成
- 特别适合技术教程、产品对比、配置指南类文章
- 此功能为**可选**，不会自动执行

**使用方法：**
```
1、先运行 /write [主题] 生成文章
2、文章保存后，运行 /image 自动添加配图
3、或运行 /image articles/文章名.md 指定文章
```

**注意**：自动配图需要Unsplash MCP服务器，请确保已正确配置

---

## 📚 必读文档（执行前必须读取）

**在开始创作前，必须先读取以下核心文档**：

1. **爆款规律手册**
   - 文件：`.claude/skills/gongzhonghao-writer/prompts/baokuan-rules.md`
   - 内容：基于232篇历史数据分析的爆款规律、**12大爆款公式**、标题黄金法则、真实性验证、版本更新框架、发文前检查清单
   - 用途：确保标题和内容符合爆款标准

2. **🔴 格式规范清单**
   - 文件：`.claude/skills/gongzhonghao-writer/prompts/format-rules.md`
   - 内容：Markdown格式硬性规范（分隔线、标题、代码块、序号、表格等）
   - 用途：**写作后必须对照检查，确保格式100%符合要求**

**⚠️ 重要**：两个文档都必须读取，爆款规律+格式规范缺一不可！

---

## ⚡ 执行流程（完全自动）

当用户输入 `/write {主题}` 后，你必须**按顺序自动完成**以下步骤：

### 🕐 步骤-1：确认当前日期（必须首先执行）

**⚠️ Critical Thinking：AI没有内置日期感知，必须先确认"今天是哪天"**

```javascript
// 方法1：使用Task工具调用日期代理（推荐）
Task(subagent_type="get-current-datetime", prompt="获取当前日期时间")

// 方法2：直接执行Bash命令
Bash("date '+%Y-%m-%d %H:%M:%S'")
```

**存储日期变量供后续Research使用**：
```
TODAY = "2025-12-20"  // 从上述命令获取实际日期
YEAR_MONTH = "December 2025"
```

**⚠️ 重要**：后续所有搜索查询必须使用这些真实日期，不要用静态的"2025"或"今天"！

---

### 🎯 步骤0：选题过滤（推荐执行）

**建议在正式写作前先运行 `/topic-filter [主题]` 确认选题分类和策略**

如果跳过此步骤直接写作，系统会自动判断：

1. **检查是否为核心工具类**（品牌词匹配）
2. **检查时效性**（热点期 vs 常青期）
3. **如涉及具体新产品**：用WebSearch确认发布时间
   - 一个月内发布 → 热点期，快写
   - 一个月以上 → 常青期，慢写打磨

**选题分类决定写作策略**：
| 分类 | 时效性 | 策略 |
|------|--------|------|
| 核心工具类 | 热点期 | 🔥 追热点，快写！ |
| 核心工具类 | 常青期 | 📚 做教程，慢写 |
| 泛AI话题类 | 热点期 | 🎯 博爆款！ |
| 泛AI话题类 | 常青期 | 🤔 谨慎写 |

### 📖 步骤1：读取爆款规律文档（必须执行）

使用Read工具读取核心文档：
```
Read(".claude/skills/gongzhonghao-writer/prompts/baokuan-rules.md")
```

**基于这个文档的指导执行后续步骤！**

### 📝 步骤2：智能判断（必须执行）

分析主题，判断是否需要research：

**需要research的情况**（包含以下任一关键词）：
- 最新、趋势、对比、测评、深度、分析
- 市场、数据、统计、排名、评测
- 工具名称（Claude、Cursor、GPT、Copilot等）

**无需research的情况**：
- 个人经验分享、使用心得
- 纯观点类文章

### 🔍 步骤3：深度Research（如需要）

**如果需要research，必须遵循 `baokuan-rules.md` 的指导**：

**Research目标（必须达到）**：
- ✅ 调用至少3个MCP工具（不是2个！）
- ✅ 找到5个以上实战案例/提示词（可直接复制使用）
- ✅ 收集3组以上权威数据对比
- ✅ 挖掘至少1个独家角度（Reddit反馈/官方文档隐藏功能）
- ✅ 提供10条以上参考来源

**必须自动调用的工具（优先级排序）**：

#### 优先级1：网页搜索最新信息（首选，通过MCP Router可用）
```
必须实际执行以下工具调用（使用步骤-1获取的日期变量！）：

mcp__mcp-router__search(
    query="{主题} 最新信息 {TODAY}",
    search_service="google",
    max_results=10
)

# 或使用内置WebSearch
WebSearch(query="{主题} 最新 {TODAY} {YEAR_MONTH}")
```

**⚠️ 日期使用规范**：
- `{TODAY}` = 当天日期（如：2025-12-20）
- `{YEAR_MONTH}` = 月份年份（如：December 2025）
- 搜索"最新"时必须带具体日期，否则可能返回过时内容！

#### 优先级2：深度搜索（Exa，通过MCP Router可用）
```
如果需要更深度的搜索，使用：

mcp__exa__web_search_exa(
    query="{主题}",
    numResults=8,
    type="auto"
)

或者用于代码相关查询：

mcp__exa__get_code_context_exa(
    query="{技术主题}",
    tokensNum=5000
)
```

#### 优先级3：技术文档查询（Context7，通过MCP Router可用）
```
如果涉及具体技术工具，查询官方文档：

mcp__context7__resolve_library_uri(libraryName="{工具名}")
# 等待返回resourceURI后再调用
mcp__context7__search_library_docs(
    resourceURI="{从上一步获取}",
    topic="features usage",
    tokens=5000
)
```

#### 优先级4：内置工具（备选，无需MCP）
```
如果MCP工具报错或不可用，使用Claude内置工具（同样使用日期变量！）：

WebSearch(query="{主题} {TODAY}")
WebFetch(url="{具体网址}")

```

**⚠️ 重要**：
- 必须真正调用工具，不是展示代码！
- 调用后等待结果返回
- 基于结果内容写作
- 至少成功调用2个不同的工具

### ✍️ 步骤4：自动创作文章（必须执行）

**🔴 写作前必须读取格式规范**：
```
Read(".claude/skills/gongzhonghao-writer/prompts/format-rules.md")
```

基于research结果（如有）+ 老金风格V6规范 + **格式规范**，自动创作完整文章。

**⚠️ 格式硬性要求（必须遵守）**：
1. **不要用`---`分隔线** → 直接用`##`标题分隔章节
2. **标题后不空行** → `## 标题\n正文`（紧贴）
3. **代码块前不空行** → `正文：\n```markdown`（紧贴）
4. **序号用顿号** → `1、2、3、`（不用`1.`或`-`）
5. **禁用Markdown表格** → 用列表替代

**老金风格核心要求**：
- 人设：产品经理视角，**根据主题灵活调整"不会XX"的描述**
  - AI编程工具类 → "虽然不会写代码"
  - 音乐工具类 → "虽然不会弹琴"或"不懂音乐制作"
  - 设计工具类 → "虽然不会设计"
  - **重要：只说与主题直接相关的"不会XX"，不要什么都加！音乐文章别提代码，代码文章别提音乐！**
- 语言：大白话，像和朋友聊天
- 结构：自然流畅，不要死板的1234格式
- 序号：用顿号（1、2、3、）不要用点号
- 情感：真实不做作，可以用"乖乖""艹"等口语
- 强调：用 **加粗** 而不是"引号"（例如：**端着金饭碗要饭** 而不是"端着金饭碗要饭"）
- **换行和分段规则**：
  - **一句一行**：每个句号/问号后都换行
  - **冒号后换行**（但不空行）
  - **核心：同一段落内的句子之间不空行，只有段落结束后才空行**
  - **引号前后都要换行**：引号单独成段，引号前空行，引号后空行
  - **重要：引号内的句号、问号、冒号都不换行！** 引号内容必须保持完整

  - **段落判断标准**：
    - ✅ **同一段落**（句子间不空行）：
      - 逻辑紧密的并列：`如果你是Plus用户，现在就能看到5.1选项了。\n免费用户得再等几天，OpenAI正在逐步推送。`
      - 问答关系：`用了5.1不习惯？\n没关系，还能切回GPT-5。`
      - 冒号引出说明：`OpenAI这次给了两个选择：\n一个叫Instant即时版，一个叫Thinking思考版。`
      - 主题+例子：`Instant主打快速响应。\n打个比方，你问它"北京今天天气怎么样"，它秒答。\n但你要是问"帮我分析这段代码哪里有性能问题"，它会多想几秒再回答。`
      - 同主题多方面描述：`Thinking版本专门应对复杂问题，会根据问题难度调整思考时间。\n而且回答更清晰，那些让人头疼的专业术语少多了。\n适合处理工作上那些需要深度分析的东西。`
      - 对比关系：`工作时切专业模式，ChatGPT回答特别规范。\n下班后切友好模式，聊天感觉像跟朋友唠嗑。`
    - ✅ **独立段落**（前后空行）：
      - 独立观点/总结：`这个自适应推理挺聪明的——简单问题不浪费时间，复杂问题认真思考。`
      - 话题转折：`这次5.1直接针对这个痛点开刀了。\n\n怎么用上GPT-5.1?`
      - 标题：`八种性格随便选（这个真香）\n\n最让我惊喜的是性格定制功能。`

  - 正确格式示例：
    ```
    OpenAI这次给了两个选择：
    一个叫Instant即时版，一个叫Thinking思考版。

    Instant主打快速响应。
    打个比方，你问它"北京今天天气怎么样"，它秒答。
    但你要是问"帮我分析这段代码哪里有性能问题"，它会多想几秒再回答。

    这个自适应推理挺聪明的——简单问题不浪费时间，复杂问题认真思考。
    ```

**文章结构建议**：
- 开头：反常识钩子，打掉误解
- 中间：具体案例 + 真实数据 + 个人体验
- 结尾：趋势升华，自然收尾

### 📝 步骤5：自动生成爆款标题（必须执行）

**调用标题生成器脚本**：

```bash
cd ".claude/skills/gongzhonghao-writer/scripts" && python title_generator.py "{主题关键词}" --full
```

**脚本说明**：
- `title_generator.py` 是统一的标题生成模块，基于82篇数据验证
- `--full` 参数输出完整报告（含评分、星级、推荐理由）
- 自动检测品牌词、场景类型，应用最优公式

**公式优先级（数据驱动）**：
1. 🏆 工具推荐型 [5.25x] - 最强公式
2. ⭐ 效率承诺型 [1.68x]
3. ⭐ 痛点解决型 [1.65x]
4. ⭐ 品牌词型 [1.59x]
5. 版本解读型 [0.94x]

**⚠️ 已删除的无效公式**：
- ❌ FOMO型（99%不知道）：effectiveness=0.00，82篇零命中
- ❌ 情绪词（惊了/麻了）：effectiveness=0.32x，负相关！

**输出示例**：
```
============================================================
📌 爆款标题生成报告：Claude Code新功能
============================================================

【推荐标题1】老金用Claude Code写了半年代码才知道，原来一直少了这个神器 ← 推荐
公式：工具推荐型
SEO评分：95分
爆款指数：⭐⭐⭐⭐⭐

【推荐标题2】Claude Code开始限制了？手把手教你怎么过
公式：痛点解决型
SEO评分：85分
爆款指数：⭐⭐⭐⭐

...

------------------------------------------------------------
**老金推荐使用：标题1**
推荐理由：工具推荐公式效果5.25x，"用了X时间才知道"制造真实感+神器推荐激发好奇心；Claude是S级品牌词，自带流量和搜索热度；标题超30字，信息量足够吸引点击；综合评分90+，具备冲百万阅读的潜力！
------------------------------------------------------------
```

### 💾 步骤6：自动保存（必须执行）

创作完成后，自动保存到articles目录：

**🔴 文件命名格式（强制规范）**：
```
YYYY-MM-DD_[分类]_[时效]_[品牌]_标题.md
```

| 字段 | 可选值 | 说明 |
|------|--------|------|
| 日期 | `2025-12-12` | 当天日期 |
| 分类 | `核心` / `泛AI` | 核心工具类 or 泛AI话题类 |
| 时效 | `热点` / `常青` | 一个月内发布=热点，教程指南=常青 |
| 品牌 | `Cursor`/`Claude`/`Kimi`等 | 核心工具池品牌词 |
| 标题 | 去掉标点的完整标题 | 保持可读性 |

**示例**：
- `2025-12-12_核心_热点_Cursor_Cursor2.2更新Debug Mode来了终于能看AI到底在想啥了.md`
- `2025-12-09_核心_常青_Claude_老金用Claude Code半年才知道原来一直少装了这个省钱神器.md`

**⚠️ 保存前必须验证文件名**：
```bash
cd ".claude/skills/gongzhonghao-writer/scripts" && python filename_validator.py "你的文件名.md"
```

**如果不确定分类/时效，用这个命令生成**：
```bash
python filename_validator.py --suggest "标题" "品牌" "核心" "热点"
```

**文章格式要求**：
```markdown
# {使用推荐标题1}

## 备选标题

【推荐标题2】{标题内容}
【推荐标题3】{标题内容}
【推荐标题4】{标题内容}
【推荐标题5】{标题内容}

**老金推荐使用：标题X**
推荐理由：{详细说明为什么这个标题最能冲百万阅读量，包含痛点分析、数字对比、情绪冲击等关键要素}

---

{文章正文开始}
...
```

**使用Write工具保存并记录文件路径**

---

### 📊 步骤6.5：智能生成信息图（可选功能）

**文章保存后，可运行 `/infographic` 命令生成专业信息图！**

#### 🔍 适用场景

**适合生成信息图的文章类型**：
- 文章包含"vs"、"对比"、"比较" → 生成对比表格
- 文章包含多组数据对比（3组以上） → 生成数据卡片
- 文章包含"步骤"、"流程"、"安装" → 生成流程图

**不适合的文章类型**：
- 纯观点输出文章
- 故事叙述类文章
- 短文章（<1500字）
- 个人经验分享（无数据对比）

#### 🎨 使用方法

**文章保存后，手动运行信息图命令**：

```bash
# 方式1：自动查找最新文章
/infographic

# 方式2：指定文章文件
/infographic articles/2025-12-02_Claude对比_老金风格.md
```

**信息图类型**：
- **对比表格**：产品对比、技术对比、方案对比
- **数据卡片**：关键数据、核心指标、统计数据
- **流程图**：步骤说明、工作流、安装教程

#### 📋 输出示例

```
✅ 信息图生成完成！

📊 信息图类型：对比表格
- 对比对象：Claude Opus 4.5、Sonnet 4.5
- 对比维度：7个

📸 生成结果：
- HTML: infographics/opus45_vs_sonnet45_comparison.html
- 截图: images/infographic_opus45_vs_sonnet45.png

📝 已插入文章：Line 189
```

**⚠️ 注意**：
- 信息图为**可选功能**，不会自动执行
- 需要Playwright MCP服务器支持截图功能
- 一篇文章建议最多**3张信息图**（避免过度使用）
- 如果Playwright不可用，只保留HTML文件

---

### 📊 步骤7：自动质量检测（必须执行）

保存文章后，立即运行质量检测脚本：

**检测方法**：使用Bash工具运行Python检测脚本

```bash
cd "C:\Users\admin\Desktop\说明\.claude\skills\gongzhonghao-writer\scripts" && python -X utf8 -c "import sys; import io; sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8'); from pathlib import Path; from quality_detector import QualityDetector; content = Path(r'{文章完整路径}').read_text(encoding='utf-8'); detector = QualityDetector(); score = detector.detect(content); print(detector.generate_report(score)); sys.exit(0 if score.is_passed() else 1)"
```

**输出示例**：
```
==================================================
老金质量检测报告（9维度）
==================================================

【AI腔检测】: 5.0分 ✅ 通过
【自然度】: 100.0分 ✅ 通过
【真诚度】: 80.0分 ✅ 通过
【啰嗦度】: 9.8分 ✅ 通过
【重复度】: 0.0% ✅ 通过
【可读性】: 87.0分 ✅ 通过
【人味儿指数】: 75.0分 ✅ 通过
【情感真实性】: 80.0分 ✅ 通过
【脏话检测】: 0处 ✅ 通过

==================================================
【最终结果】: ✅ 全部通过！文章质量杠杠的！
==================================================
```

**9维度检测标准**（V6统一）：

| 维度 | 合格标准 |
|------|---------|
| AI腔检测 | <20分 |
| 自然度 | >80分 |
| 真诚度 | >75分 |
| 啰嗦度 | <25分 |
| 重复度 | <15% |
| 可读性 | >85分 |
| 人味儿指数 | >70分 |
| 情感真实性 | >75分 |
| 脏话检测 | =0处（V6保持） |

**如果检测不通过**：
1、查看详细质量报告
2、修改文章内容
3、重新保存，再次触发检测

---

### ✅ 步骤8：发文前检查清单（必须执行）

**遵循 `baokuan-rules.md` 的5维度检查清单**：

#### 1、Research深度检查
- □ 调用了至少3个MCP工具？
- □ 有5个以上实战案例/提示词？
- □ 有3组以上权威数据对比？
- □ 有至少1个独家角度？
- □ 有10条以上参考来源？

#### 2、标题吸引力检查
- □ 使用了12大公式之一？
- □ 有数字冲击（100万/3倍/5个）？
- □ 有情绪词（惊了/麻了/吓到）？
- □ 长度15-25字？
- □ 关键词前置？

#### 3、内容实用性检查
- □ 有可直接复制的提示词/代码？
- □ 有详细使用步骤（1、2、3、）？
- □ 有避坑指南？
- □ 有最佳实践建议？
- □ 读者看完能立即用起来？

#### 4、独特性检查
- □ 有别人没写的角度？
- □ 有独家信息（Reddit/官方文档）？
- □ 有真实案例/故事？
- □ 有"99%的人不知道"的点？

#### 5、传播性检查
- □ 有让人想转发的点（实惠/稀缺/实用/情绪）？
- □ 开头就点出核心价值？
- □ 结尾有引导分享？

**⚠️ 5维度全部打�� → 发布**
**任何一维度不满足 → 继续优化**

---

## ✅ 完整示例

### 示例1：需要research的主题

```
用户: /gongzhonghao Claude Code使用技巧

自动执行流程：

1、判断：包含"Claude Code"工具名 → 需要research

2、Research：
   - 调用 context7 查询Claude Code文档
   - 调用 open-websearch 搜索最新教程
   - 等待结果返回...

3、创作：
   基于查询到的官方文档 + 最新教程 + 老金风格
   写一篇2000-3000字的完整文章

4、生成标题：
   【推荐标题1】Claude Code这23个技巧不知道？你只用了5%功能
   公式：数字对比型 + 损失厌恶型
   SEO评分：9.5分
   爆款指数：⭐⭐⭐⭐⭐

   【推荐标题2】用Claude Code半年才发现，我一直在用最笨的方法
   公式：时间成本型 + 反思认知型
   SEO评分：9分
   爆款指数：⭐⭐⭐⭐⭐

   【推荐标题3】Claude Code高手都在用的23个技巧，第8个绝了
   公式：权威背书型 + 好奇缺口型
   SEO评分：8.5分
   爆款指数：⭐⭐⭐⭐

   【推荐标题4】掌握这些Claude Code技巧，代码效率暴涨3倍
   公式：价值承诺型 + 数字对比型
   SEO评分：8分
   爆款指数：⭐⭐⭐⭐

   【推荐标题5】Claude Code实用技巧大全，老金压箱底的都在这
   公式：资源清单型 + 稀缺性暗示型
   SEO评分：7.5分
   爆款指数：⭐⭐⭐

   **老金推荐使用：标题1**
   推荐理由：23个技巧具体又吸引人，"只用了5%功能"这个损失感太强了！谁都不想浪费95%的功能，必须点开看看自己错过了什么。FOMO效应拉满！

5、保存：
   articles/2025-11-08_Claude_Code使用技巧_老金风格.md
   （文章末尾包含备选标题）

5.5、智能生成信息图：
   检测到对比类内容（Claude Code vs 其他工具）
   自动生成对比表格信息图
   截图并插入文章合适位置
   路径：../images/infographic_comparison.png

6、质量检测：
   自动运行Python检测脚本
   输出9维度质量报告（含脏话检测）
   如果不通过，修改文章重新保存
```

### 示例2：无需research的主题

```
用户: /gongzhonghao 分享我的AI工具使用心得

自动执行流程：

1、判断：纯个人经验分享 → 无需research

2、直接创作：
   基于老金风格写一篇个人心得

3、生成标题：
   【推荐标题1】用AI工具3个月，我扔掉了5个传统软件
   公式：时间成本型 + 意外发现型
   SEO评分：8.5分
   爆款指数：⭐⭐⭐⭐

   【推荐标题2】AI工具使用千万别踩这3个坑，第2个我亏大了
   公式：踩坑避雷型 + 损失厌恶型
   SEO评分：9分
   爆款指数：⭐⭐⭐⭐⭐

   【推荐标题3】AI工具真能提效？老金用了100天给你答案
   公式：实测体验型 + 争议观点型
   SEO评分：8.5分
   爆款指数：⭐⭐⭐⭐

   【推荐标题4】90%的人用AI工具都在犯这个错误
   公式：人群筛选型 + 踩坑避雷型
   SEO评分：8分
   爆款指数：⭐⭐⭐⭐

   【推荐标题5】AI工具使用心得，压箱底的经验全在这了
   公式：资源清单型 + 稀缺性暗示型
   SEO评分：7.5分
   爆款指数：⭐⭐⭐

   **老金推荐使用：标题2**
   推荐理由：踩坑话题人人关心，"第2个我亏大了"制造了强烈的好奇心和损失厌恶，让人必须点开看是什么坑这么严重！

4、保存：
   articles/2025-11-08_AI工具使用心得_老金风格.md

4.5、智能检测：
   检测文章类型：个人经验分享，无数据对比
   判断：不生成信息图（符合标准）

5、质量检测：
   自动运行Python检测脚本
   输出9维度质量报告（含脏话检测）
   如果不通过，修改文章重新保存
```

---

## 🎯 关键原则

**必须做到**：
✅ 自动调用MCP工具，不问用户
✅ 基于真实数据写作，不编造
✅ 严格遵循老金风格，自然流畅
✅ 自动保存到articles目录
✅ 自动运行质量检测并查看报告

**绝对禁止**：
❌ 问用户"是否需要research" - 必须自动判断！
❌ 展示代码不执行 - 必须真正调用工具！
❌ 使用markdown列表格式(- xxx) - 必须用顿号！
❌ 质量检测不通过就发布 - 必须修改到通过！

---

**老金提示**：艹，这才是真正的全自动！你只需要输入主题，剩下的全部交给系统！
